brigitte - install docs
=======================

This is just one way to install and configure brigitte. Feel free to user
other software (apache instead of nginx, postgres instead of mysql, ...).

1. Requirements
---------------

- up and running mysql server (including db user and empty database)
- up and running redis server (for caching)
- up and running nginx webserver (with uwsgi support)
- up and running supervisor (for gitsshserver and uwsgi)

- some packages (names are based on debian's apt-get)
  - python-setuptools
  - python-dev
  - build-essential
  - gettext
  - git-daemon-run

2. Prepare environment as root
------------------------------

- install pip and virtualenv:
  - easy_install pip
  - pip install virtualenv

- download and compile git
  - cd /usr/src
  - wget http://kernel.org/pub/software/scm/git/git-1.7.11.3.tar.gz
  - tar xzf git-1.7.11.3.tar.gz and cd
  - ./configure && make && make install

- download and install uwsgi
  - cd /usr/src
  - wget http://projects.unbit.it/downloads/uwsgi-1.2.4.tar.gz
  - tar xzf uwsgi-1.2.4 and cd
  - python setup.py install

- add user for brigitte
  - adduser brigitte

2. Prepare environment as brigitte
----------------------------------

- create and activate virtualenv
  - cd ~
  - virtualenv env
  - cd env
  - . ./bin/activate

3. Install and configure brigitte
---------------------------------

- prepare ssh keys
  - ssh-keygen -t dsa -f ~/env/gitsshserver

- install and configure brigitte
  - git clone git://github.com/stephrdev/brigitte.git
  - cd brigitte
  - python setup.py develop
  - pip install -r requirements.txt
  - cd brigitte_site & add a settings.py
    - cp dev.sample.py settings.py
    - edit settings.py
        - BRIGITTE_SSH_KEY_PATH = '/home/brigitte/env/gitsshserver'
        - BRIGITTE_GIT_BASE_PATH = '/home/brigitte/repositories/'
  - manage.py syncdb
  - manage.py migrate

(you could now user manage.py runserver 0.0.0.0:8000 to check if everything
works until now - database, python modules, etc....)

4. Configure nginx, uwsgi and supervisor
----------------------------------------

- configure uwsgi and nginx
  - mkdir ~/env/deploy (and cd)
  - cp ../brigitte/docs/nginx.conf.sample nginx.conf
  - cp ../brigitte/docs/gitdaemon.sample gitdaemon
  - cp ../brigitte/docs/uwsgi.sample uwsgi
  - cp ../brigitte/docs/gitsshserver.sample gitsshserver
  - edit files to fit your needs

- activate your configs (as root)
  - ln /home/brigitte/env/deploy/nginx.conf /etc/nginx/conf.d/brigitte.conf
  - ln /home/brigitte/env/deploy/gitdaemon /etc/supervisord/conf.d/gitdaemon
  - ln /home/brigitte/env/deploy/uwsgi /etc/supervisord/conf.d/uwsgi
  - ln /home/brigitte/env/deploy/gitsshserver /etc/supervisord/conf.d/gitsshserver

After restarting the servers, everything should work. *fingers crossed*
